var ajaxgo=false;jQuery(document).ready(function(){var userform=jQuery('.userform');function req_go(data,form,options){if(ajaxgo){form.find('.response').html('<p class="error">Wait for previous request.</p>');return false;}form.find('input[type="submit"]').attr('disabled','disabled').val('Loading..');form.find('.response').html('');ajaxgo=true;}function req_come(data,statusText,xhr,form){console.log(arguments);if(data.success){var response='<p class="success">'+data.data.message+'</p>';form.find('input[type="submit"]').hide()
form.find('.submit_close_form').removeClass('hidden');}else{var response='<p class="error">'+data.data.message+'</p>';form.find('input[type="submit"]').prop('disabled',false).val('Send');}form.find('.response').html(response);if(data.data.redirect)window.location.href=data.data.redirect;ajaxgo=false;}var args={dataType:'json',beforeSubmit:req_go,success:req_come,error:function(data){console.log(arguments);console.log(data);},url:'/wp-admin/admin-ajax.php',};userform.ajaxForm(args);jQuery('.logout').click(function(e){e.preventDefault();if(ajaxgo)return false;var lnk=jQuery(this);jQuery.ajax({type:'POST',url:'/wp-admin/admin-ajax.php',dataType:'json',data:'action=logout_me&nonce='+jQuery(this).data('nonce'),beforeSend:function(data){lnk.text('Loading...');ajaxgo=true;},success:function(data){if(data.success){lnk.text('Logout...');window.location.reload(true);}else{alert(data.data.message);}},error:function(xhr,ajaxOptions,thrownError){console.log(arguments);},complete:function(data){ajaxgo=false;}});});});